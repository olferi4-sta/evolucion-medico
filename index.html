<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Evoluci√≥n Cl√≠nica ‚Äì M√©dico Interno HUEM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{--azul:#1e88e5;--gris:#f4f6f8}
body{font-family:Segoe UI,Arial;background:var(--gris);padding:20px}
.container{max-width:1200px;margin:auto;background:#fff;padding:25px;border-radius:8px}
.header{border-bottom:4px solid var(--azul);margin-bottom:20px}
.section{margin-top:25px}
.section h2{background:var(--azul);color:#fff;padding:8px;border-radius:6px;font-size:15px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
input,select,textarea{width:100%;padding:8px;border:1px solid #ccc;border-radius:5px}
textarea{resize:vertical}
.actions{display:flex;gap:10px;margin-top:20px;flex-wrap:wrap}
button{background:var(--azul);color:#fff;border:none;padding:10px 18px;border-radius:6px}
button.secondary{background:#6c757d}
.error{color:#b00020}.ok{color:#1b5e20;font-weight:bold}
@media print{button,.actions{display:none}}
</style>
</head>

<body>
<div class="container">

<div class="header">
<h1>Evoluci√≥n Cl√≠nica ‚Äì M√©dico Interno</h1>
<small>Hospital Universitario Erasmo Meoz ¬∑ Simulaci√≥n acad√©mica</small>
</div>

<!-- ACCESO ESTUDIANTE -->
<div class="section">
<h2>Acceso estudiante</h2>
<input id="estudiante" placeholder="Nombre completo del estudiante">
</div>

<form id="form">

<!-- 1. IDENTIFICACI√ìN -->
<div class="section">
<h2>1. Identificaci√≥n del paciente</h2>
<div class="grid">
<select id="tipoDoc">
<option value="">Tipo documento</option>
<option>RC</option><option>TI</option><option>CC</option>
<option>CE</option><option>PS</option><option>SV</option>
</select>
<input id="numDoc" placeholder="Documento">
<input id="nombre" placeholder="Nombre completo">
<input type="number" id="edad" placeholder="Edad">

<select id="sexo">
<option value="">Sexo</option>
<option>Masculino</option><option>Femenino</option><option>Intersexual</option>
</select>

<select id="orientacion">
<option value="">Orientaci√≥n sexual</option>
<option>Heterosexual</option><option>Homosexual</option>
<option>Bisexual</option><option>Otro</option>
</select>

<select id="etnia">
<option value="">Etnia</option>
<option>Mestizo</option><option>Afrodescendiente</option>
<option>Ind√≠gena</option><option>ROM</option><option>No aplica</option>
</select>

<select id="discapacidad">
<option value="">Discapacidad</option>
<option>No</option><option>F√≠sica</option>
<option>Sensorial</option><option>Cognitiva</option>
</select>

<input id="direccion" placeholder="Direcci√≥n">
<input id="barrio" placeholder="Barrio">

<select id="ciudad">
<option value="">Ciudad</option>
<option>C√∫cuta</option><option>Los Patios</option>
<option>Villa del Rosario</option>
<option>Otra</option>
</select>

<select id="pais">
<option value="">Pa√≠s</option>
<option>Colombia</option><option>Venezuela</option><option>Otro</option>
</select>

<select id="eps">
<option value="">EPS</option>
<option>Nueva EPS</option><option>Sanitas</option>
<option>Sura</option><option>Coosalud</option>
<option>Salud Total</option><option>Otra</option>
</select>

<input id="servicio" placeholder="Servicio cl√≠nico">
</div>
</div>

<!-- 2. SUBJETIVO -->
<div class="section">
<h2>2. Subjetivo</h2>
<textarea id="subjetivo" placeholder="Motivo de consulta y s√≠ntomas (m√≠nimo 30 caracteres)"></textarea>
</div>

<!-- 3. SIGNOS VITALES -->
<div class="section">
<h2>3. Signos vitales</h2>
<div class="grid">
<input type="number" id="peso" placeholder="Peso (kg)" oninput="imcCalc()">
<input type="number" id="talla" placeholder="Talla (cm)" oninput="imcCalc()">
<input id="imc" placeholder="IMC" readonly>
<input type="number" id="tas" placeholder="TA Sist√≥lica">
<input type="number" id="tad" placeholder="TA Diast√≥lica">
<input type="number" id="fc" placeholder="Frecuencia cardiaca">
<input type="number" id="glasgow" placeholder="Glasgow (3‚Äì15)">
</div>
</div>

<!-- 4. OBJETIVO Y AN√ÅLISIS -->
<div class="section">
<h2>4. Evoluci√≥n objetiva y an√°lisis</h2>
<textarea id="objetivo" placeholder="Hallazgos al examen f√≠sico (m√≠nimo 30 caracteres)"></textarea>
<textarea id="analisis" placeholder="An√°lisis cl√≠nico (m√≠nimo 50 caracteres)"></textarea>
</div>

<!-- 5. DIAGN√ìSTICO -->
<div class="section">
<h2>5. Diagn√≥stico (CIE-10)</h2>

<label><input type="checkbox" class="dxCheck" value="J18"> J18 ‚Äì Neumon√≠a</label><br>
<label><input type="checkbox" class="dxCheck" value="I10"> I10 ‚Äì Hipertensi√≥n</label><br>
<label><input type="checkbox" class="dxCheck" value="E11"> E11 ‚Äì Diabetes tipo 2</label><br>

<input id="dxLibre" placeholder="Otro CIE-10 (si no est√° en la lista)">
</div>

<!-- 6. INDICACIONES M√âDICAS -->
<div class="section">
<h2>6. Indicaciones m√©dicas</h2>
<textarea id="medicamentos" placeholder="Medicamentos (m√≠nimo 30 caracteres)"></textarea>
<textarea id="paraclinicos" placeholder="Paracl√≠nicos / ayudas diagn√≥sticas"></textarea>
<textarea id="cuidados" placeholder="Cuidados generales"></textarea>

<select id="dieta">
<option value="">Dieta</option>
<option>Libre</option><option>Blanda</option>
<option>Hipos√≥dica</option><option>Diab√©tica</option>
</select>
</div>

<div id="errores" class="error"></div>
<div id="ok" class="ok"></div>

<div class="actions">
<button type="submit">Validar evoluci√≥n</button>
<button type="button" class="secondary" onclick="window.print()">PDF</button>
<button type="button" class="secondary" onclick="descargarCSV()">CSV</button>
<button type="button" class="secondary" onclick="enviarSheets()">Enviar evoluci√≥n</button>
</div>

</form>
</div>

<script>
function imcCalc(){
 if(peso.value && talla.value)
 imc.value=(peso.value/Math.pow(talla.value/100,2)).toFixed(1);
}

form.addEventListener("submit",e=>{
 e.preventDefault();
 let err=[];
 if(!estudiante.value) err.push("Debe identificarse el estudiante");
 if(!tipoDoc.value||!numDoc.value||!nombre.value) err.push("Identificaci√≥n incompleta");
 if(subjetivo.value.length<30) err.push("Subjetivo insuficiente");
 if(!peso.value||!talla.value||!tas.value||!tad.value||!fc.value) err.push("Signos vitales incompletos");
 if(objetivo.value.length<30) err.push("Objetivo insuficiente");
 if(analisis.value.length<50) err.push("An√°lisis insuficiente");
 if(!document.querySelector(".dxCheck:checked")&&!dxLibre.value) err.push("Diagn√≥stico obligatorio");
 if(medicamentos.value.length<30) err.push("Indicaciones m√©dicas incompletas");

 errores.innerHTML=err.join("<br>");
 ok.innerHTML=err.length===0?"EVOLUCI√ìN CONFORME":"";
 resultadoConforme = err.length===0;
});

function enviarSheets(){
 const dxSeleccionados=[...document.querySelectorAll(".dxCheck:checked")]
 .map(d=>d.value).join(" | ") || dxLibre.value;

 fetch("üî¥ PEGA AQU√ç TU URL DE GOOGLE APPS SCRIPT üî¥",{
 method:"POST",
 headers:{"Content-Type":"application/json"},
 body:JSON.stringify({
  estudiante:estudiante.value,
  tipoDoc:tipoDoc.value,
  numDoc:numDoc.value,
  nombre:nombre.value,
  edad:edad.value,
  sexo:sexo.value,
  orientacion:orientacion.value,
  etnia:etnia.value,
  discapacidad:discapacidad.value,
  direccion:direccion.value,
  barrio:barrio.value,
  ciudad:ciudad.value,
  pais:pais.value,
  eps:eps.value,
  servicio:servicio.value,
  peso:peso.value,
  talla:talla.value,
  imc:imc.value,
  tas:tas.value,
  tad:tad.value,
  fc:fc.value,
  glasgow:glasgow.value,
  subjetivo:subjetivo.value,
  objetivo:objetivo.value,
  analisis:analisis.value,
  dx:dxSeleccionados,
  medicamentos:medicamentos.value,
  paraclinicos:paraclinicos.value,
  cuidados:cuidados.value,
  dieta:dieta.value,
  conforme: resultadoConforme?"SI":"NO"
 })
 }).then(()=>alert("‚úî Evoluci√≥n almacenada en Google Sheets"));
}

function descargarCSV(){
 const csv=[["Estudiante","Documento","Paciente","DX","IMC","Conforme"],
 [estudiante.value,numDoc.value,nombre.value,dxLibre.value,imc.value,resultadoConforme?"SI":"NO"]]
 .map(r=>r.join(",")).join("\n");
 const a=document.createElement("a");
 a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
 a.download="evolucion.csv";a.click();
}
</script>

</body>
</html>
